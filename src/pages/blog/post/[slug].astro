---
// Back-compat dynamic route for old `/blog/post/{slug}` URLs.
// Exports getStaticPaths so Astro's pre-renderer won't error. Pages redirect to canonical `/blog/{slug}`.

import { getAllSlugs } from "../../../lib/posts";

// Pre-render all legacy post-slugs to satisfy Astro's requirement for dynamic routes
export async function getStaticPaths(): Promise<Array<{ params: { slug: string } }>> {
  const slugs = getAllSlugs();
  return slugs.map(s => ({ params: { slug: s } }));
}

const slug = String(Astro.params.slug ?? '');
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Redirecting…</title>
    <meta http-equiv="refresh" content={`0;url=/blog/${slug}`} />
  </head>
  <body style="background:#0b1220;color:#e6edf3;font-family:Inter,system-ui,sans-serif;min-height:100vh;display:flex;align-items:center;justify-content:center;">
    <div style="max-width:640px;padding:24px;text-align:center;">
      <h1 style="margin-bottom:8px;">Moved permanently</h1>
      <p style="margin-bottom:12px;">This post has moved to <a href={`/blog/${slug}`} style="color:#8b5cf6">/blog/{slug}</a>. Redirecting now…</p>
      <p>If your browser doesn't redirect, <a href={`/blog/${slug}`} style="color:#8b5cf6">click here</a>.</p>
    </div>
  </body>
</html>
